"use client";

import { useEffect, useRef } from "react";
import { useRouter } from "next/navigation";

export default function Analytics(): React.ReactElement {
  const sparklesRef = useRef<HTMLDivElement | null>(null);
  const searchBoxRef = useRef<HTMLDivElement | null>(null);
  const router = useRouter();

  useEffect(() => {
    const container = sparklesRef.current;
    if (!container) return;

    const sparkleCount = 300;
    const sparkles: HTMLDivElement[] = [];

    for (let i = 0; i < sparkleCount; i++) {
      const sparkle = document.createElement("div") as HTMLDivElement;
      sparkle.className = "sparkle";

      // Random position
      sparkle.style.left = `${Math.random() * 100}%`;
      sparkle.style.top = `${Math.random() * 100}%`;

      // Random size between ~1px and ~2px
      const size = 1 + Math.random() * 1;
      sparkle.style.width = `${size}px`;
      sparkle.style.height = `${size}px`;

      // Random animation delay & duration
      sparkle.style.animationDelay = `${Math.random() * 3}s`;
      sparkle.style.animationDuration = `${2 + Math.random() * 2}s`;

      container.appendChild(sparkle);
      sparkles.push(sparkle);
    }

    const handleMouseMove = (e: MouseEvent) => {
      const mouseX = e.clientX / window.innerWidth;
      const mouseY = e.clientY / window.innerHeight;

      sparkles.forEach((sparkle, index) => {
        const speed = ((index % 3) + 1) * 0.5;
        const x = (mouseX - 0.5) * speed;
        const y = (mouseY - 0.5) * speed;
        sparkle.style.transform = `translate(${x}px, ${y}px)`;
      });
    };

    window.addEventListener("mousemove", handleMouseMove);

    return () => {
      window.removeEventListener("mousemove", handleMouseMove);
      sparkles.forEach((s) => s.remove());
    };
  }, []);

  const handleCardClick = (title: string) => {
    // console.log(`Opening ${title} analytics...`);
  };

  return (
    <div className="analytics-root">
      <div className="sparkles-container" ref={sparklesRef} id="sparkles" />

      <div className="content-wrapper">
        <header className="header">
          <div
            className="title cursor-pointer"
            onClick={() => router.push("/landing/explore")}
          >
            Tikle
          </div>
          <div className="profile-menu">
            <div
              className="public-beta cursor-pointer"
              onClick={() => router.push("/dashboard/view-filings")}
            >
              Public Beta
            </div>
            <div className="avatar" aria-hidden>
              üë§
            </div>
          </div>
        </header>
        <div className="cards-container" role="list">
          <div
            style={{display: "flex", justifyContent: "center"}}
            className="card"
            role="listitem"
            onClick={() => handleCardClick("Schedule of Investments")}
          >
            Coming Soon
          </div>
        </div>

        {/* <main className="main-content">
          <h1 className="page-title">Analytics</h1>
          <p className="page-subtitle">
            Unlock premium insights and advanced analytics tailored for your BDC
          </p>

          <div className="search-container">
            <div className="search-box" ref={searchBoxRef}>
              <input
                type="text"
                className="search-input"
                placeholder="Enter a BDC name"
                onFocus={() =>
                  (searchBoxRef.current!.style.transform = "scale(1.02)")
                }
                onBlur={() =>
                  (searchBoxRef.current!.style.transform = "scale(1)")
                }
                aria-label="Search BDC"
              />
              <div className="search-icon" aria-hidden>
                üîç
              </div>
            </div>
          </div>

          <div className="cards-container" role="list">
            <div
              className="card"
              role="listitem"
              onClick={() => handleCardClick("Schedule of Investments")}
            >
              <div className="card-icon sqi-icon">üìä</div>
              <div className="card-title">Schedule of Investments</div>
              <div className="card-description">
                Organize and prioritize tasks effectively for your tech business.
              </div>
            </div>

            <div
              className="card"
              role="listitem"
              onClick={() => handleCardClick("Earnings")}
            >
              <div className="card-icon earnings-icon">üí∞</div>
              <div className="card-title">Earnings</div>
              <div className="card-description">
                Stay informed with instant notifications on payments and revenue
                growth.
              </div>
            </div>

            <div
              className="card"
              role="listitem"
              onClick={() => handleCardClick("Historical Data")}
            >
              <div className="card-icon organization-icon">üè¢</div>
              <div className="card-title">Historical Data</div>
              <div className="card-description">
                Foster teamwork with integrated communication tools.
              </div>
            </div>
          </div>
        </main>
        

        <div className="spline-container">
          <iframe
            src="https://my.spline.design/genkubgreetingrobot-M3150V0D7hSaqs4gqy9VQa5q/"
            title="3D Scene"
            frameBorder={0}
            width="100%"
            height="200px"
            style={{ border: "none", borderRadius: 12, background: "transparent" }}
            loading="lazy"
          />
        </div> */}
      </div>

      <style>{`
        * { box-sizing: border-box; }
        .analytics-root { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background-color: #000000; color: #ffffff; min-height: 100vh; overflow-x: hidden; }
        .sparkles-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; pointer-events: none; }
        .sparkle { position: absolute; width: 2px; height: 2px; background: #ffffff; border-radius: 50%; animation: sparkle 3s linear infinite; opacity: 0; }
        @keyframes sparkle { 0%,100% { opacity: 0; transform: scale(0);} 50% { opacity: 1; transform: scale(1);} }
        .content-wrapper { position: relative; z-index: 1; min-height: 100vh; }
        .header { display: flex; justify-content: space-between; align-items: center; padding: 20px 40px; border-bottom: 1px solid rgba(42,42,42,0.3); backdrop-filter: blur(10px); }
        .title { font-size: 24px; font-weight: 600; }
        .profile-menu { display:flex; align-items:center; gap:15px; }
        .public-beta { background: rgba(51,51,51,0.8); padding:6px 12px; border-radius:16px; font-size:12px; color:#ccc; backdrop-filter: blur(10px); }
        .avatar { width:32px; height:32px; border-radius:50%; background:#4f46e5; display:flex; align-items:center; justify-content:center; font-weight:600; }
        .main-content { padding:40px; max-width:1200px; margin:0 auto; }
        .page-title { font-size:32px; font-weight:700; margin-bottom:8px; text-shadow:0 0 20px rgba(255,255,255,0.1); text-align:center; }
        .page-subtitle { color:#888; margin-bottom:40px; text-align:center; }
        .search-container { display:flex; justify-content:center; margin-bottom:50px; }
        .search-box { position:relative; width:100%; max-width:600px; }
        .search-input { width:100%; padding:16px 50px 16px 20px; background: rgba(26,26,26,0.8); border:1px solid rgba(51,51,51,0.5); border-radius:25px; color:#fff; font-size:16px; outline:none; transition: all 0.3s ease; backdrop-filter: blur(10px); }
        .search-input:focus { border-color: #4f46e5; box-shadow: 0 0 0 2px rgba(79,70,229,0.2), 0 0 30px rgba(79,70,229,0.1); }
        .search-input::placeholder { color:#666; }
        .search-icon { position:absolute; right:20px; top:50%; transform: translateY(-50%); color:#666; font-size:18px; }
        .cards-container { display:grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap:20px; max-width:1000px; margin:0 auto; }
        @keyframes rotate { 100% { transform: rotate(1turn); } }
        .card { position:relative; z-index:0; background:#000000; border-radius:12px; padding:24px; transition: all 0.3s ease; cursor:pointer; overflow:hidden; box-shadow: 0 0 20px rgba(57,153,83,0.3), 0 0 80px rgba(55,122,245,0.2); }
        .card::before { content:''; position:absolute; z-index:-2; left:-50%; top:-50%; width:200%; height:200%; background-repeat:no-repeat; background-size:50% 50%,50% 50%; background-position:0 0,100% 0,100% 100%,0 100%; background-image: linear-gradient(#377af5,#377af5); animation: rotate 8s linear infinite; filter: blur(8px); }
        .card::after { content:''; position:absolute; z-index:-1; left:3px; top:3px; width:calc(100% - 6px); height:calc(100% - 6px); background:#000000; border-radius:9px; }
        .card:hover { transform: translateY(-2px); }
        .card-icon { width:40px; height:40px; border-radius:8px; margin-bottom:16px; display:flex; align-items:center; justify-content:center; font-size:20px; position:relative; z-index:1; }
        .card-title { font-size:18px; font-weight:600; margin-bottom:8px; position:relative; z-index:1; }
        .card-description { color:#888; font-size:14px; line-height:1.5; position:relative; z-index:1; }
        .sqi-icon { background: linear-gradient(135deg, #ff6b6b, #ee5a24); }
        .earnings-icon { background: linear-gradient(135deg, #4ecdc4, #44a08d); }
        .organization-icon { background: linear-gradient(135deg, #a55eea, #8b68ea); }
        .spline-container { padding: 0 40px; margin: 40px auto 20px; max-width: 1200px; }
        @media (max-width: 768px) {
          .header { padding: 15px 20px; }
          .main-content { padding: 20px; }
          .page-title { font-size: 24px; }
          .cards-container { grid-template-columns: 1fr; }
          .spline-container { padding: 0 20px; margin: 0px auto 20px; }
          .spline-container iframe { height: 300px; }
        }
      `}</style>
    </div>
  );
}
